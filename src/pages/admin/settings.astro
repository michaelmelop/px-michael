---
import AdminLayout from '../../layouts/AdminLayout.astro';
---

<AdminLayout title="Configuración del Sistema" currentPage="settings">
  <div class="settings-container">
    <!-- Header -->
    <div class="settings-header mb-6">
      <h1 class="page-title">Configuración del Sistema</h1>
      <p class="page-subtitle">Administra la configuración general del sistema</p>
    </div>

    <!-- Settings Tabs -->
    <div class="settings-tabs mb-6">
      <button class="tab-button active" onclick="showTab('general')">General</button>
      <button class="tab-button" onclick="showTab('notifications')">Notificaciones</button>
      <button class="tab-button" onclick="showTab('security')">Seguridad</button>
      <button class="tab-button" onclick="showTab('integrations')">Integraciones</button>
    </div>

    <!-- General Settings -->
    <div id="general-tab" class="settings-tab active">
      <div class="settings-section card mb-6">
        <div class="card-header">
          <h3>Configuración General</h3>
        </div>
        <div class="card-body">
          <form class="settings-form">
            <div class="form-group">
              <label class="form-label">Nombre del Sistema</label>
              <input type="text" class="form-input" value="Mi Sistema Admin" placeholder="Nombre del sistema">
            </div>
            <div class="form-group">
              <label class="form-label">Descripción</label>
              <textarea class="form-textarea" rows="3" placeholder="Descripción del sistema">Sistema de administración para gestión de usuarios y productos</textarea>
            </div>
            <div class="form-group">
              <label class="form-label">Zona Horaria</label>
              <select class="form-select">
                <option value="UTC">UTC</option>
                <option value="America/Mexico_City" selected>América/Ciudad de México</option>
                <option value="America/New_York">América/Nueva York</option>
                <option value="Europe/Madrid">Europa/Madrid</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Idioma Predeterminado</label>
              <select class="form-select">
                <option value="es" selected>Español</option>
                <option value="en">Inglés</option>
                <option value="fr">Francés</option>
                <option value="de">Alemán</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Modo de Mantenimiento</label>
              <div class="toggle-switch">
                <input type="checkbox" id="maintenance-mode" class="toggle-input">
                <label for="maintenance-mode" class="toggle-label">
                  <span class="toggle-text">Activar modo de mantenimiento</span>
                </label>
              </div>
            </div>
          </form>
        </div>
      </div>

      <div class="settings-section card">
        <div class="card-header">
          <h3>Configuración de Apariencia</h3>
        </div>
        <div class="card-body">
          <form class="settings-form">
            <div class="form-group">
              <label class="form-label">Tema</label>
              <select class="form-select">
                <option value="light" selected>Claro</option>
                <option value="dark">Oscuro</option>
                <option value="auto">Automático</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Color Primario</label>
              <div class="color-picker">
                <input type="color" class="color-input" value="#3b82f6">
                <span class="color-preview" style="background-color: #3b82f6;"></span>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Logo del Sistema</label>
              <div class="file-upload">
                <input type="file" id="logo-upload" accept="image/*" class="file-input">
                <label for="logo-upload" class="file-label">
                  <span class="file-icon">📁</span>
                  <span class="file-text">Seleccionar archivo</span>
                </label>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Notifications Settings -->
    <div id="notifications-tab" class="settings-tab">
      <div class="settings-section card mb-6">
        <div class="card-header">
          <h3>Configuración de Notificaciones</h3>
        </div>
        <div class="card-body">
          <form class="settings-form">
            <div class="form-group">
              <label class="form-label">Notificaciones por Email</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input type="checkbox" id="email-users" checked>
                  <label for="email-users">Nuevos usuarios registrados</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="email-orders" checked>
                  <label for="email-orders">Nuevos pedidos</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="email-products">
                  <label for="email-products">Productos con stock bajo</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="email-system">
                  <label for="email-system">Alertas del sistema</label>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Email de Administrador</label>
              <input type="email" class="form-input" value="admin@example.com" placeholder="Email del administrador">
            </div>
            <div class="form-group">
              <label class="form-label">Frecuencia de Reportes</label>
              <select class="form-select">
                <option value="daily">Diario</option>
                <option value="weekly" selected>Semanal</option>
                <option value="monthly">Mensual</option>
                <option value="never">Nunca</option>
              </select>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Security Settings -->
    <div id="security-tab" class="settings-tab">
      <div class="settings-section card mb-6">
        <div class="card-header">
          <h3>Configuración de Seguridad</h3>
        </div>
        <div class="card-body">
          <form class="settings-form">
            <div class="form-group">
              <label class="form-label">Política de Contraseñas</label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input type="checkbox" id="password-length" checked>
                  <label for="password-length">Mínimo 8 caracteres</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="password-uppercase" checked>
                  <label for="password-uppercase">Requiere mayúsculas</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="password-numbers">
                  <label for="password-numbers">Requiere números</label>
                </div>
                <div class="checkbox-item">
                  <input type="checkbox" id="password-symbols">
                  <label for="password-symbols">Requiere símbolos</label>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Tiempo de Sesión (minutos)</label>
              <input type="number" class="form-input" value="30" min="5" max="480">
            </div>
            <div class="form-group">
              <label class="form-label">Intentos de Login Fallidos</label>
              <input type="number" class="form-input" value="5" min="1" max="10">
            </div>
            <div class="form-group">
              <label class="form-label">Autenticación de Dos Factores</label>
              <div class="toggle-switch">
                <input type="checkbox" id="two-factor" class="toggle-input">
                <label for="two-factor" class="toggle-label">
                  <span class="toggle-text">Requerir 2FA para administradores</span>
                </label>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Integrations Settings -->
    <div id="integrations-tab" class="settings-tab">
      <div class="settings-section card mb-6">
        <div class="card-header">
          <h3>Integraciones Externas</h3>
        </div>
        <div class="card-body">
          <div class="integrations-list">
            <div class="integration-item">
              <div class="integration-info">
                <div class="integration-icon">📧</div>
                <div class="integration-details">
                  <h4 class="integration-name">Email SMTP</h4>
                  <p class="integration-description">Configuración del servidor de email</p>
                </div>
              </div>
              <div class="integration-actions">
                <span class="integration-status connected">Conectado</span>
                <button class="btn btn-sm btn-secondary">Configurar</button>
              </div>
            </div>
            
            <div class="integration-item">
              <div class="integration-info">
                <div class="integration-icon">💳</div>
                <div class="integration-details">
                  <h4 class="integration-name">Stripe</h4>
                  <p class="integration-description">Procesamiento de pagos</p>
                </div>
              </div>
              <div class="integration-actions">
                <span class="integration-status disconnected">Desconectado</span>
                <button class="btn btn-sm btn-primary">Conectar</button>
              </div>
            </div>
            
            <div class="integration-item">
              <div class="integration-info">
                <div class="integration-icon">📊</div>
                <div class="integration-details">
                  <h4 class="integration-name">Google Analytics</h4>
                  <p class="integration-description">Análisis de tráfico web</p>
                </div>
              </div>
              <div class="integration-actions">
                <span class="integration-status connected">Conectado</span>
                <button class="btn btn-sm btn-secondary">Configurar</button>
              </div>
            </div>
            
            <div class="integration-item">
              <div class="integration-info">
                <div class="integration-icon">☁️</div>
                <div class="integration-details">
                  <h4 class="integration-name">AWS S3</h4>
                  <p class="integration-description">Almacenamiento en la nube</p>
                </div>
              </div>
              <div class="integration-actions">
                <span class="integration-status disconnected">Desconectado</span>
                <button class="btn btn-sm btn-primary">Conectar</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Save Button -->
    <div class="settings-footer">
      <button class="btn btn-primary" onclick="saveSettings()">Guardar Configuración</button>
      <button class="btn btn-secondary" onclick="resetSettings()">Restablecer</button>
    </div>
  </div>
</AdminLayout>

<style>
  .settings-container {
    max-width: 800px;
    margin: 0 auto;
  }

  .page-title {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--color-text);
    margin-bottom: 0.25rem;
  }

  .page-subtitle {
    color: var(--color-text-secondary);
    font-size: 0.875rem;
  }

  .settings-tabs {
    display: flex;
    gap: 0.5rem;
    border-bottom: 1px solid var(--color-border);
    margin-bottom: 2rem;
  }

  .tab-button {
    background: none;
    border: none;
    padding: 0.75rem 1rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-text-secondary);
    cursor: pointer;
    border-bottom: 2px solid transparent;
    transition: all 0.2s ease;
  }

  .tab-button:hover {
    color: var(--color-text);
  }

  .tab-button.active {
    color: var(--color-primary);
    border-bottom-color: var(--color-primary);
  }

  .settings-tab {
    display: none;
  }

  .settings-tab.active {
    display: block;
  }

  .settings-form {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .form-label {
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-text);
  }

  .form-input,
  .form-select,
  .form-textarea {
    padding: 0.5rem;
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius);
    font-size: 0.875rem;
    font-family: inherit;
  }

  .form-textarea {
    resize: vertical;
  }

  .toggle-switch {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .toggle-input {
    display: none;
  }

  .toggle-label {
    position: relative;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    cursor: pointer;
  }

  .toggle-label::before {
    content: '';
    width: 40px;
    height: 20px;
    border-radius: 10px;
    background-color: var(--color-border);
    transition: background-color 0.2s ease;
  }

  .toggle-label::after {
    content: '';
    position: absolute;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background-color: white;
    left: 2px;
    top: 50%;
    transform: translateY(-50%);
    transition: transform 0.2s ease;
  }

  .toggle-input:checked + .toggle-label::before {
    background-color: var(--color-primary);
  }

  .toggle-input:checked + .toggle-label::after {
    transform: translateY(-50%) translateX(20px);
  }

  .toggle-text {
    font-size: 0.875rem;
    color: var(--color-text);
  }

  .color-picker {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .color-input {
    width: 40px;
    height: 40px;
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius);
    cursor: pointer;
  }

  .color-preview {
    width: 40px;
    height: 40px;
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius);
    display: inline-block;
  }

  .file-upload {
    position: relative;
  }

  .file-input {
    display: none;
  }

  .file-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: border-color 0.2s ease;
  }

  .file-label:hover {
    border-color: var(--color-primary);
  }

  .file-icon {
    font-size: 1.25rem;
  }

  .file-text {
    font-size: 0.875rem;
    color: var(--color-text-secondary);
  }

  .checkbox-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .checkbox-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .checkbox-item input[type="checkbox"] {
    width: 16px;
    height: 16px;
    accent-color: var(--color-primary);
  }

  .checkbox-item label {
    font-size: 0.875rem;
    color: var(--color-text);
    cursor: pointer;
  }

  .integrations-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .integration-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    border: 1px solid var(--color-border);
    border-radius: var(--border-radius);
    transition: border-color 0.2s ease;
  }

  .integration-item:hover {
    border-color: var(--color-primary);
  }

  .integration-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .integration-icon {
    font-size: 1.5rem;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: var(--color-background);
    border-radius: var(--border-radius);
  }

  .integration-name {
    font-size: 1rem;
    font-weight: 600;
    color: var(--color-text);
    margin-bottom: 0.25rem;
  }

  .integration-description {
    font-size: 0.875rem;
    color: var(--color-text-secondary);
  }

  .integration-actions {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .integration-status {
    padding: 0.25rem 0.5rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 500;
  }

  .integration-status.connected {
    background-color: #d1fae5;
    color: #059669;
  }

  .integration-status.disconnected {
    background-color: #fef3c7;
    color: #d97706;
  }

  .settings-footer {
    display: flex;
    gap: 1rem;
    justify-content: flex-end;
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid var(--color-border);
  }

  /* Mobile responsive */
  @media (max-width: 768px) {
    .settings-tabs {
      flex-wrap: wrap;
    }

    .integration-item {
      flex-direction: column;
      gap: 1rem;
      align-items: stretch;
    }

    .integration-actions {
      justify-content: space-between;
    }

    .settings-footer {
      flex-direction: column;
    }
  }
</style>

<script>
  function showTab(tabName) {
    // Hide all tabs
    const tabs = document.querySelectorAll('.settings-tab');
    tabs.forEach(tab => tab.classList.remove('active'));
    
    // Hide all tab buttons
    const buttons = document.querySelectorAll('.tab-button');
    buttons.forEach(button => button.classList.remove('active'));
    
    // Show selected tab
    document.getElementById(tabName + '-tab').classList.add('active');
    
    // Activate corresponding button
    event.target.classList.add('active');
  }

  function saveSettings() {
    // Simulate saving settings
    alert('Configuración guardada exitosamente');
  }

  function resetSettings() {
    if (confirm('¿Estás seguro de que deseas restablecer la configuración?')) {
      alert('Configuración restablecida');
    }
  }
</script>